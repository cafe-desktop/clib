
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - clib (cppcheck 2.3-1)</title>
    <link rel="stylesheet" href="style.css">
    <style>
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - clib (cppcheck 2.3-1): gio/gtlsclientconnection.c</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> gtlsclientconnection.c</p>
<a href="94.html#line-175"> varFuncNullUB 175</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="cm">/* GIO - GLib Input, Output and Streaming Library</span>
<a name="line-2"></a><span class="cm"> *</span>
<a name="line-3"></a><span class="cm"> * Copyright Â© 2010 Red Hat, Inc</span>
<a name="line-4"></a><span class="cm"> *</span>
<a name="line-5"></a><span class="cm"> * This library is free software; you can redistribute it and/or</span>
<a name="line-6"></a><span class="cm"> * modify it under the terms of the GNU Lesser General Public</span>
<a name="line-7"></a><span class="cm"> * License as published by the Free Software Foundation; either</span>
<a name="line-8"></a><span class="cm"> * version 2.1 of the License, or (at your option) any later version.</span>
<a name="line-9"></a><span class="cm"> *</span>
<a name="line-10"></a><span class="cm"> * This library is distributed in the hope that it will be useful,</span>
<a name="line-11"></a><span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="line-12"></a><span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="line-13"></a><span class="cm"> * Lesser General Public License for more details.</span>
<a name="line-14"></a><span class="cm"> *</span>
<a name="line-15"></a><span class="cm"> * You should have received a copy of the GNU Lesser General</span>
<a name="line-16"></a><span class="cm"> * Public License along with this library; if not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="line-17"></a><span class="cm"> */</span>
<a name="line-18"></a>
<a name="line-19"></a><span class="cp">#include</span> <span class="cpf">&quot;config.h&quot;</span><span class="cp"></span>
<a name="line-20"></a><span class="cp">#include</span> <span class="cpf">&quot;glib.h&quot;</span><span class="cp"></span>
<a name="line-21"></a>
<a name="line-22"></a><span class="cp">#include</span> <span class="cpf">&quot;gtlsclientconnection.h&quot;</span><span class="cp"></span>
<a name="line-23"></a><span class="cp">#include</span> <span class="cpf">&quot;ginitable.h&quot;</span><span class="cp"></span>
<a name="line-24"></a><span class="cp">#include</span> <span class="cpf">&quot;gioenumtypes.h&quot;</span><span class="cp"></span>
<a name="line-25"></a><span class="cp">#include</span> <span class="cpf">&quot;gsocket.h&quot;</span><span class="cp"></span>
<a name="line-26"></a><span class="cp">#include</span> <span class="cpf">&quot;gsocketconnectable.h&quot;</span><span class="cp"></span>
<a name="line-27"></a><span class="cp">#include</span> <span class="cpf">&quot;gtlsbackend.h&quot;</span><span class="cp"></span>
<a name="line-28"></a><span class="cp">#include</span> <span class="cpf">&quot;gtlscertificate.h&quot;</span><span class="cp"></span>
<a name="line-29"></a><span class="cp">#include</span> <span class="cpf">&quot;glibintl.h&quot;</span><span class="cp"></span>
<a name="line-30"></a>
<a name="line-31"></a><span class="cm">/**</span>
<a name="line-32"></a><span class="cm"> * SECTION:gtlsclientconnection</span>
<a name="line-33"></a><span class="cm"> * @short_description: TLS client-side connection</span>
<a name="line-34"></a><span class="cm"> * @include: gio/gio.h</span>
<a name="line-35"></a><span class="cm"> *</span>
<a name="line-36"></a><span class="cm"> * #GTlsClientConnection is the client-side subclass of</span>
<a name="line-37"></a><span class="cm"> * #GTlsConnection, representing a client-side TLS connection.</span>
<a name="line-38"></a><span class="cm"> */</span>
<a name="line-39"></a>
<a name="line-40"></a><span class="cm">/**</span>
<a name="line-41"></a><span class="cm"> * GTlsClientConnection:</span>
<a name="line-42"></a><span class="cm"> *</span>
<a name="line-43"></a><span class="cm"> * Abstract base class for the backend-specific client connection</span>
<a name="line-44"></a><span class="cm"> * type.</span>
<a name="line-45"></a><span class="cm"> *</span>
<a name="line-46"></a><span class="cm"> * Since: 2.28</span>
<a name="line-47"></a><span class="cm"> */</span>
<a name="line-48"></a>
<a name="line-49"></a><span class="n">G_DEFINE_INTERFACE</span> <span class="p">(</span><span class="n">GTlsClientConnection</span><span class="p">,</span> <span class="n">g_tls_client_connection</span><span class="p">,</span> <span class="n">G_TYPE_TLS_CONNECTION</span><span class="p">)</span>
<a name="line-50"></a>
<a name="line-51"></a><span class="k">static</span> <span class="kt">void</span>
<a name="line-52"></a><span class="n">g_tls_client_connection_default_init</span> <span class="p">(</span><span class="n">GTlsClientConnectionInterface</span> <span class="o">*</span><span class="n">iface</span><span class="p">)</span>
<a name="line-53"></a><span class="p">{</span>
<a name="line-54"></a>  <span class="cm">/**</span>
<a name="line-55"></a><span class="cm">   * GTlsClientConnection:validation-flags:</span>
<a name="line-56"></a><span class="cm">   *</span>
<a name="line-57"></a><span class="cm">   * What steps to perform when validating a certificate received from</span>
<a name="line-58"></a><span class="cm">   * a server. Server certificates that fail to validate in any of the</span>
<a name="line-59"></a><span class="cm">   * ways indicated here will be rejected unless the application</span>
<a name="line-60"></a><span class="cm">   * overrides the default via #GTlsConnection::accept-certificate.</span>
<a name="line-61"></a><span class="cm">   *</span>
<a name="line-62"></a><span class="cm">   * Since: 2.28</span>
<a name="line-63"></a><span class="cm">   */</span>
<a name="line-64"></a>  <span class="n">g_object_interface_install_property</span> <span class="p">(</span><span class="n">iface</span><span class="p">,</span>
<a name="line-65"></a>				       <span class="n">g_param_spec_flags</span> <span class="p">(</span><span class="s">&quot;validation-flags&quot;</span><span class="p">,</span>
<a name="line-66"></a>							   <span class="n">P_</span><span class="p">(</span><span class="s">&quot;Validation flags&quot;</span><span class="p">),</span>
<a name="line-67"></a>							   <span class="n">P_</span><span class="p">(</span><span class="s">&quot;What certificate validation to perform&quot;</span><span class="p">),</span>
<a name="line-68"></a>							   <span class="n">G_TYPE_TLS_CERTIFICATE_FLAGS</span><span class="p">,</span>
<a name="line-69"></a>							   <span class="n">G_TLS_CERTIFICATE_VALIDATE_ALL</span><span class="p">,</span>
<a name="line-70"></a>							   <span class="n">G_PARAM_READWRITE</span> <span class="o">|</span>
<a name="line-71"></a>							   <span class="n">G_PARAM_CONSTRUCT</span> <span class="o">|</span>
<a name="line-72"></a>							   <span class="n">G_PARAM_STATIC_STRINGS</span><span class="p">));</span>
<a name="line-73"></a>
<a name="line-74"></a>  <span class="cm">/**</span>
<a name="line-75"></a><span class="cm">   * GTlsClientConnection:server-identity:</span>
<a name="line-76"></a><span class="cm">   *</span>
<a name="line-77"></a><span class="cm">   * A #GSocketConnectable describing the identity of the server that</span>
<a name="line-78"></a><span class="cm">   * is expected on the other end of the connection.</span>
<a name="line-79"></a><span class="cm">   *</span>
<a name="line-80"></a><span class="cm">   * If the %G_TLS_CERTIFICATE_BAD_IDENTITY flag is set in</span>
<a name="line-81"></a><span class="cm">   * #GTlsClientConnection:validation-flags, this object will be used</span>
<a name="line-82"></a><span class="cm">   * to determine the expected identify of the remote end of the</span>
<a name="line-83"></a><span class="cm">   * connection; if #GTlsClientConnection:server-identity is not set,</span>
<a name="line-84"></a><span class="cm">   * or does not match the identity presented by the server, then the</span>
<a name="line-85"></a><span class="cm">   * %G_TLS_CERTIFICATE_BAD_IDENTITY validation will fail.</span>
<a name="line-86"></a><span class="cm">   *</span>
<a name="line-87"></a><span class="cm">   * In addition to its use in verifying the server certificate,</span>
<a name="line-88"></a><span class="cm">   * this is also used to give a hint to the server about what</span>
<a name="line-89"></a><span class="cm">   * certificate we expect, which is useful for servers that serve</span>
<a name="line-90"></a><span class="cm">   * virtual hosts.</span>
<a name="line-91"></a><span class="cm">   *</span>
<a name="line-92"></a><span class="cm">   * Since: 2.28</span>
<a name="line-93"></a><span class="cm">   */</span>
<a name="line-94"></a>  <span class="n">g_object_interface_install_property</span> <span class="p">(</span><span class="n">iface</span><span class="p">,</span>
<a name="line-95"></a>				       <span class="n">g_param_spec_object</span> <span class="p">(</span><span class="s">&quot;server-identity&quot;</span><span class="p">,</span>
<a name="line-96"></a>							    <span class="n">P_</span><span class="p">(</span><span class="s">&quot;Server identity&quot;</span><span class="p">),</span>
<a name="line-97"></a>							    <span class="n">P_</span><span class="p">(</span><span class="s">&quot;GSocketConnectable identifying the server&quot;</span><span class="p">),</span>
<a name="line-98"></a>							    <span class="n">G_TYPE_SOCKET_CONNECTABLE</span><span class="p">,</span>
<a name="line-99"></a>							    <span class="n">G_PARAM_READWRITE</span> <span class="o">|</span>
<a name="line-100"></a>							    <span class="n">G_PARAM_CONSTRUCT</span> <span class="o">|</span>
<a name="line-101"></a>							    <span class="n">G_PARAM_STATIC_STRINGS</span><span class="p">));</span>
<a name="line-102"></a>
<a name="line-103"></a>  <span class="cm">/**</span>
<a name="line-104"></a><span class="cm">   * GTlsClientConnection:use-ssl3:</span>
<a name="line-105"></a><span class="cm">   *</span>
<a name="line-106"></a><span class="cm">   * SSL 3.0 is no longer supported. See</span>
<a name="line-107"></a><span class="cm">   * g_tls_client_connection_set_use_ssl3() for details.</span>
<a name="line-108"></a><span class="cm">   *</span>
<a name="line-109"></a><span class="cm">   * Since: 2.28</span>
<a name="line-110"></a><span class="cm">   *</span>
<a name="line-111"></a><span class="cm">   * Deprecated: 2.56: SSL 3.0 is insecure.</span>
<a name="line-112"></a><span class="cm">   */</span>
<a name="line-113"></a>  <span class="n">g_object_interface_install_property</span> <span class="p">(</span><span class="n">iface</span><span class="p">,</span>
<a name="line-114"></a>				       <span class="n">g_param_spec_boolean</span> <span class="p">(</span><span class="s">&quot;use-ssl3&quot;</span><span class="p">,</span>
<a name="line-115"></a>							     <span class="n">P_</span><span class="p">(</span><span class="s">&quot;Use fallback&quot;</span><span class="p">),</span>
<a name="line-116"></a>							     <span class="n">P_</span><span class="p">(</span><span class="s">&quot;Use fallback version of SSL/TLS rather than most recent version&quot;</span><span class="p">),</span>
<a name="line-117"></a>							     <span class="n">FALSE</span><span class="p">,</span>
<a name="line-118"></a>							     <span class="n">G_PARAM_READWRITE</span> <span class="o">|</span>
<a name="line-119"></a>							     <span class="n">G_PARAM_CONSTRUCT</span> <span class="o">|</span>
<a name="line-120"></a>							     <span class="n">G_PARAM_STATIC_STRINGS</span> <span class="o">|</span>
<a name="line-121"></a>							     <span class="n">G_PARAM_DEPRECATED</span><span class="p">));</span>
<a name="line-122"></a>
<a name="line-123"></a>  <span class="cm">/**</span>
<a name="line-124"></a><span class="cm">   * GTlsClientConnection:accepted-cas: (type GLib.List) (element-type GLib.ByteArray)</span>
<a name="line-125"></a><span class="cm">   *</span>
<a name="line-126"></a><span class="cm">   * A list of the distinguished names of the Certificate Authorities</span>
<a name="line-127"></a><span class="cm">   * that the server will accept client certificates signed by. If the</span>
<a name="line-128"></a><span class="cm">   * server requests a client certificate during the handshake, then</span>
<a name="line-129"></a><span class="cm">   * this property will be set after the handshake completes.</span>
<a name="line-130"></a><span class="cm">   *</span>
<a name="line-131"></a><span class="cm">   * Each item in the list is a #GByteArray which contains the complete</span>
<a name="line-132"></a><span class="cm">   * subject DN of the certificate authority.</span>
<a name="line-133"></a><span class="cm">   *</span>
<a name="line-134"></a><span class="cm">   * Since: 2.28</span>
<a name="line-135"></a><span class="cm">   */</span>
<a name="line-136"></a>  <span class="n">g_object_interface_install_property</span> <span class="p">(</span><span class="n">iface</span><span class="p">,</span>
<a name="line-137"></a>				       <span class="n">g_param_spec_pointer</span> <span class="p">(</span><span class="s">&quot;accepted-cas&quot;</span><span class="p">,</span>
<a name="line-138"></a>							     <span class="n">P_</span><span class="p">(</span><span class="s">&quot;Accepted CAs&quot;</span><span class="p">),</span>
<a name="line-139"></a>							     <span class="n">P_</span><span class="p">(</span><span class="s">&quot;Distinguished names of the CAs the server accepts certificates from&quot;</span><span class="p">),</span>
<a name="line-140"></a>							     <span class="n">G_PARAM_READABLE</span> <span class="o">|</span>
<a name="line-141"></a>							     <span class="n">G_PARAM_STATIC_STRINGS</span><span class="p">));</span>
<a name="line-142"></a><span class="p">}</span>
<a name="line-143"></a>
<a name="line-144"></a><span class="cm">/**</span>
<a name="line-145"></a><span class="cm"> * g_tls_client_connection_new:</span>
<a name="line-146"></a><span class="cm"> * @base_io_stream: the #GIOStream to wrap</span>
<a name="line-147"></a><span class="cm"> * @server_identity: (nullable): the expected identity of the server</span>
<a name="line-148"></a><span class="cm"> * @error: #GError for error reporting, or %NULL to ignore.</span>
<a name="line-149"></a><span class="cm"> *</span>
<a name="line-150"></a><span class="cm"> * Creates a new #GTlsClientConnection wrapping @base_io_stream (which</span>
<a name="line-151"></a><span class="cm"> * must have pollable input and output streams) which is assumed to</span>
<a name="line-152"></a><span class="cm"> * communicate with the server identified by @server_identity.</span>
<a name="line-153"></a><span class="cm"> *</span>
<a name="line-154"></a><span class="cm"> * See the documentation for #GTlsConnection:base-io-stream for restrictions</span>
<a name="line-155"></a><span class="cm"> * on when application code can run operations on the @base_io_stream after</span>
<a name="line-156"></a><span class="cm"> * this function has returned.</span>
<a name="line-157"></a><span class="cm"> *</span>
<a name="line-158"></a><span class="cm"> * Returns: (transfer full) (type GTlsClientConnection): the new</span>
<a name="line-159"></a><span class="cm"> * #GTlsClientConnection, or %NULL on error</span>
<a name="line-160"></a><span class="cm"> *</span>
<a name="line-161"></a><span class="cm"> * Since: 2.28</span>
<a name="line-162"></a><span class="cm"> */</span>
<a name="line-163"></a><span class="n">GIOStream</span> <span class="o">*</span>
<a name="line-164"></a><span class="n">g_tls_client_connection_new</span> <span class="p">(</span><span class="n">GIOStream</span>           <span class="o">*</span><span class="n">base_io_stream</span><span class="p">,</span>
<a name="line-165"></a>			     <span class="n">GSocketConnectable</span>  <span class="o">*</span><span class="n">server_identity</span><span class="p">,</span>
<a name="line-166"></a>			     <span class="n">GError</span>             <span class="o">**</span><span class="n">error</span><span class="p">)</span>
<a name="line-167"></a><span class="p">{</span>
<a name="line-168"></a>  <span class="n">GObject</span> <span class="o">*</span><span class="n">conn</span><span class="p">;</span>
<a name="line-169"></a>  <span class="n">GTlsBackend</span> <span class="o">*</span><span class="n">backend</span><span class="p">;</span>
<a name="line-170"></a>
<a name="line-171"></a>  <span class="n">backend</span> <span class="o">=</span> <span class="n">g_tls_backend_get_default</span> <span class="p">();</span>
<a name="line-172"></a>  <span class="n">conn</span> <span class="o">=</span> <span class="n">g_initable_new</span> <span class="p">(</span><span class="n">g_tls_backend_get_client_connection_type</span> <span class="p">(</span><span class="n">backend</span><span class="p">),</span>
<a name="line-173"></a>			 <span class="nb">NULL</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span>
<a name="line-174"></a>			 <span class="s">&quot;base-io-stream&quot;</span><span class="p">,</span> <span class="n">base_io_stream</span><span class="p">,</span>
<a name="line-175"></a><span class="hll">			 <span class="s">&quot;server-identity&quot;</span><span class="p">,</span> <span class="n">server_identity</span><span class="p">,</span><div class="verbose expandable"><span class="error2">&lt;--- Passing NULL after the last typed argument to a variadic function leads to undefined behaviour. <span class="marker">[+]</span></span><div class="content">Passing NULL after the last typed argument to a variadic function leads to undefined behaviour.
The C99 standard, in section 7.15.1.1, states that if the type used by va_arg() is not compatible with the type of the actual next argument (as promoted according to the default argument promotions), the behavior is undefined.
The value of the NULL macro is an implementation-defined null pointer constant (7.17), which can be any integer constant expression with the value 0, or such an expression casted to (void*) (6.3.2.3). This includes values like 0, 0L, or even 0LL.
In practice on common architectures, this will cause real crashes if sizeof(int) != sizeof(void*), and NULL is defined to 0 or any other null pointer constant that promotes to int.
To reproduce you might be able to use this little code example on 64bit platforms. If the output includes &quot;ERROR&quot;, the sentinel had only 4 out of 8 bytes initialized to zero and was not detected as the final argument to stop argument processing via va_arg(). Changing the 0 to (void*)0 or 0L will make the &quot;ERROR&quot; output go away.
#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

void f(char *s, ...) {
    va_list ap;
    va_start(ap,s);
    for (;;) {
        char *p = va_arg(ap,char*);
        printf(&quot;%018p, %s\n&quot;, p, (long)p &amp; 255 ? p : &quot;&quot;);
        if(!p) break;
    }
    va_end(ap);
}

void g() {
    char *s2 = &quot;x&quot;;
    char *s3 = &quot;ERROR&quot;;

    // changing 0 to 0L for the 7th argument (which is intended to act as sentinel) makes the error go away on x86_64
    f(&quot;first&quot;, s2, s2, s2, s2, s2, 0, s3, (char*)0);
}

void h() {
    int i;
    volatile unsigned char a[1000];
    for (i = 0; i&lt;sizeof(a); i++)
        a[i] = -1;
}

int main() {
    h();
    g();
    return 0;
}</div></div>
</span><a name="line-176"></a>			 <span class="nb">NULL</span><span class="p">);</span>
<a name="line-177"></a>  <span class="k">return</span> <span class="nf">G_IO_STREAM</span> <span class="p">(</span><span class="n">conn</span><span class="p">);</span>
<a name="line-178"></a><span class="p">}</span>
<a name="line-179"></a>
<a name="line-180"></a><span class="cm">/**</span>
<a name="line-181"></a><span class="cm"> * g_tls_client_connection_get_validation_flags:</span>
<a name="line-182"></a><span class="cm"> * @conn: the #GTlsClientConnection</span>
<a name="line-183"></a><span class="cm"> *</span>
<a name="line-184"></a><span class="cm"> * Gets @conn&#39;s validation flags</span>
<a name="line-185"></a><span class="cm"> *</span>
<a name="line-186"></a><span class="cm"> * Returns: the validation flags</span>
<a name="line-187"></a><span class="cm"> *</span>
<a name="line-188"></a><span class="cm"> * Since: 2.28</span>
<a name="line-189"></a><span class="cm"> */</span>
<a name="line-190"></a><span class="n">GTlsCertificateFlags</span>
<a name="line-191"></a><span class="n">g_tls_client_connection_get_validation_flags</span> <span class="p">(</span><span class="n">GTlsClientConnection</span> <span class="o">*</span><span class="n">conn</span><span class="p">)</span>
<a name="line-192"></a><span class="p">{</span>
<a name="line-193"></a>  <span class="n">GTlsCertificateFlags</span> <span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<a name="line-194"></a>
<a name="line-195"></a>  <span class="n">g_return_val_if_fail</span> <span class="p">(</span><span class="n">G_IS_TLS_CLIENT_CONNECTION</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<a name="line-196"></a>
<a name="line-197"></a>  <span class="n">g_object_get</span> <span class="p">(</span><span class="n">G_OBJECT</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="s">&quot;validation-flags&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">flags</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-198"></a>  <span class="k">return</span> <span class="n">flags</span><span class="p">;</span>
<a name="line-199"></a><span class="p">}</span>
<a name="line-200"></a>
<a name="line-201"></a><span class="cm">/**</span>
<a name="line-202"></a><span class="cm"> * g_tls_client_connection_set_validation_flags:</span>
<a name="line-203"></a><span class="cm"> * @conn: the #GTlsClientConnection</span>
<a name="line-204"></a><span class="cm"> * @flags: the #GTlsCertificateFlags to use</span>
<a name="line-205"></a><span class="cm"> *</span>
<a name="line-206"></a><span class="cm"> * Sets @conn&#39;s validation flags, to override the default set of</span>
<a name="line-207"></a><span class="cm"> * checks performed when validating a server certificate. By default,</span>
<a name="line-208"></a><span class="cm"> * %G_TLS_CERTIFICATE_VALIDATE_ALL is used.</span>
<a name="line-209"></a><span class="cm"> *</span>
<a name="line-210"></a><span class="cm"> * Since: 2.28</span>
<a name="line-211"></a><span class="cm"> */</span>
<a name="line-212"></a><span class="kt">void</span>
<a name="line-213"></a><span class="n">g_tls_client_connection_set_validation_flags</span> <span class="p">(</span><span class="n">GTlsClientConnection</span>  <span class="o">*</span><span class="n">conn</span><span class="p">,</span>
<a name="line-214"></a>					      <span class="n">GTlsCertificateFlags</span>   <span class="n">flags</span><span class="p">)</span>
<a name="line-215"></a><span class="p">{</span>
<a name="line-216"></a>  <span class="n">g_return_if_fail</span> <span class="p">(</span><span class="n">G_IS_TLS_CLIENT_CONNECTION</span> <span class="p">(</span><span class="n">conn</span><span class="p">));</span>
<a name="line-217"></a>
<a name="line-218"></a>  <span class="n">g_object_set</span> <span class="p">(</span><span class="n">G_OBJECT</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="s">&quot;validation-flags&quot;</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-219"></a><span class="p">}</span>
<a name="line-220"></a>
<a name="line-221"></a><span class="cm">/**</span>
<a name="line-222"></a><span class="cm"> * g_tls_client_connection_get_server_identity:</span>
<a name="line-223"></a><span class="cm"> * @conn: the #GTlsClientConnection</span>
<a name="line-224"></a><span class="cm"> *</span>
<a name="line-225"></a><span class="cm"> * Gets @conn&#39;s expected server identity</span>
<a name="line-226"></a><span class="cm"> *</span>
<a name="line-227"></a><span class="cm"> * Returns: (transfer none): a #GSocketConnectable describing the</span>
<a name="line-228"></a><span class="cm"> * expected server identity, or %NULL if the expected identity is not</span>
<a name="line-229"></a><span class="cm"> * known.</span>
<a name="line-230"></a><span class="cm"> *</span>
<a name="line-231"></a><span class="cm"> * Since: 2.28</span>
<a name="line-232"></a><span class="cm"> */</span>
<a name="line-233"></a><span class="n">GSocketConnectable</span> <span class="o">*</span>
<a name="line-234"></a><span class="n">g_tls_client_connection_get_server_identity</span> <span class="p">(</span><span class="n">GTlsClientConnection</span> <span class="o">*</span><span class="n">conn</span><span class="p">)</span>
<a name="line-235"></a><span class="p">{</span>
<a name="line-236"></a>  <span class="n">GSocketConnectable</span> <span class="o">*</span><span class="n">identity</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<a name="line-237"></a>
<a name="line-238"></a>  <span class="n">g_return_val_if_fail</span> <span class="p">(</span><span class="n">G_IS_TLS_CLIENT_CONNECTION</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<a name="line-239"></a>
<a name="line-240"></a>  <span class="n">g_object_get</span> <span class="p">(</span><span class="n">G_OBJECT</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="s">&quot;server-identity&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">identity</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-241"></a>  <span class="k">if</span> <span class="p">(</span><span class="n">identity</span><span class="p">)</span>
<a name="line-242"></a>    <span class="n">g_object_unref</span> <span class="p">(</span><span class="n">identity</span><span class="p">);</span>
<a name="line-243"></a>  <span class="k">return</span> <span class="n">identity</span><span class="p">;</span>
<a name="line-244"></a><span class="p">}</span>
<a name="line-245"></a>
<a name="line-246"></a><span class="cm">/**</span>
<a name="line-247"></a><span class="cm"> * g_tls_client_connection_set_server_identity:</span>
<a name="line-248"></a><span class="cm"> * @conn: the #GTlsClientConnection</span>
<a name="line-249"></a><span class="cm"> * @identity: a #GSocketConnectable describing the expected server identity</span>
<a name="line-250"></a><span class="cm"> *</span>
<a name="line-251"></a><span class="cm"> * Sets @conn&#39;s expected server identity, which is used both to tell</span>
<a name="line-252"></a><span class="cm"> * servers on virtual hosts which certificate to present, and also</span>
<a name="line-253"></a><span class="cm"> * to let @conn know what name to look for in the certificate when</span>
<a name="line-254"></a><span class="cm"> * performing %G_TLS_CERTIFICATE_BAD_IDENTITY validation, if enabled.</span>
<a name="line-255"></a><span class="cm"> *</span>
<a name="line-256"></a><span class="cm"> * Since: 2.28</span>
<a name="line-257"></a><span class="cm"> */</span>
<a name="line-258"></a><span class="kt">void</span>
<a name="line-259"></a><span class="n">g_tls_client_connection_set_server_identity</span> <span class="p">(</span><span class="n">GTlsClientConnection</span> <span class="o">*</span><span class="n">conn</span><span class="p">,</span>
<a name="line-260"></a>					     <span class="n">GSocketConnectable</span>   <span class="o">*</span><span class="n">identity</span><span class="p">)</span>
<a name="line-261"></a><span class="p">{</span>
<a name="line-262"></a>  <span class="n">g_return_if_fail</span> <span class="p">(</span><span class="n">G_IS_TLS_CLIENT_CONNECTION</span> <span class="p">(</span><span class="n">conn</span><span class="p">));</span>
<a name="line-263"></a>
<a name="line-264"></a>  <span class="n">g_object_set</span> <span class="p">(</span><span class="n">G_OBJECT</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="s">&quot;server-identity&quot;</span><span class="p">,</span> <span class="n">identity</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-265"></a><span class="p">}</span>
<a name="line-266"></a>
<a name="line-267"></a><span class="cm">/**</span>
<a name="line-268"></a><span class="cm"> * g_tls_client_connection_get_use_ssl3:</span>
<a name="line-269"></a><span class="cm"> * @conn: the #GTlsClientConnection</span>
<a name="line-270"></a><span class="cm"> *</span>
<a name="line-271"></a><span class="cm"> * SSL 3.0 is no longer supported. See</span>
<a name="line-272"></a><span class="cm"> * g_tls_client_connection_set_use_ssl3() for details.</span>
<a name="line-273"></a><span class="cm"> *</span>
<a name="line-274"></a><span class="cm"> * Returns: %FALSE</span>
<a name="line-275"></a><span class="cm"> *</span>
<a name="line-276"></a><span class="cm"> * Since: 2.28</span>
<a name="line-277"></a><span class="cm"> *</span>
<a name="line-278"></a><span class="cm"> * Deprecated: 2.56: SSL 3.0 is insecure.</span>
<a name="line-279"></a><span class="cm"> */</span>
<a name="line-280"></a><span class="n">gboolean</span>
<a name="line-281"></a><span class="n">g_tls_client_connection_get_use_ssl3</span> <span class="p">(</span><span class="n">GTlsClientConnection</span> <span class="o">*</span><span class="n">conn</span><span class="p">)</span>
<a name="line-282"></a><span class="p">{</span>
<a name="line-283"></a>  <span class="n">gboolean</span> <span class="n">use_ssl3</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
<a name="line-284"></a>
<a name="line-285"></a>  <span class="n">g_return_val_if_fail</span> <span class="p">(</span><span class="n">G_IS_TLS_CLIENT_CONNECTION</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<a name="line-286"></a>
<a name="line-287"></a>  <span class="n">g_object_get</span> <span class="p">(</span><span class="n">G_OBJECT</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="s">&quot;use-ssl3&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">use_ssl3</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-288"></a>  <span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
<a name="line-289"></a><span class="p">}</span>
<a name="line-290"></a>
<a name="line-291"></a><span class="cm">/**</span>
<a name="line-292"></a><span class="cm"> * g_tls_client_connection_set_use_ssl3:</span>
<a name="line-293"></a><span class="cm"> * @conn: the #GTlsClientConnection</span>
<a name="line-294"></a><span class="cm"> * @use_ssl3: a #gboolean, ignored</span>
<a name="line-295"></a><span class="cm"> *</span>
<a name="line-296"></a><span class="cm"> * Since GLib 2.42.1, SSL 3.0 is no longer supported.</span>
<a name="line-297"></a><span class="cm"> *</span>
<a name="line-298"></a><span class="cm"> * From GLib 2.42.1 through GLib 2.62, this function could be used to</span>
<a name="line-299"></a><span class="cm"> * force use of TLS 1.0, the lowest-supported TLS protocol version at</span>
<a name="line-300"></a><span class="cm"> * the time. In the past, this was needed to connect to broken TLS</span>
<a name="line-301"></a><span class="cm"> * servers that exhibited protocol version intolerance. Such servers</span>
<a name="line-302"></a><span class="cm"> * are no longer common, and using TLS 1.0 is no longer considered</span>
<a name="line-303"></a><span class="cm"> * acceptable.</span>
<a name="line-304"></a><span class="cm"> *</span>
<a name="line-305"></a><span class="cm"> * Since GLib 2.64, this function does nothing.</span>
<a name="line-306"></a><span class="cm"> *</span>
<a name="line-307"></a><span class="cm"> * Since: 2.28</span>
<a name="line-308"></a><span class="cm"> *</span>
<a name="line-309"></a><span class="cm"> * Deprecated: 2.56: SSL 3.0 is insecure.</span>
<a name="line-310"></a><span class="cm"> */</span>
<a name="line-311"></a><span class="kt">void</span>
<a name="line-312"></a><span class="n">g_tls_client_connection_set_use_ssl3</span> <span class="p">(</span><span class="n">GTlsClientConnection</span> <span class="o">*</span><span class="n">conn</span><span class="p">,</span>
<a name="line-313"></a>				      <span class="n">gboolean</span>              <span class="n">use_ssl3</span><span class="p">)</span>
<a name="line-314"></a><span class="p">{</span>
<a name="line-315"></a>  <span class="n">g_return_if_fail</span> <span class="p">(</span><span class="n">G_IS_TLS_CLIENT_CONNECTION</span> <span class="p">(</span><span class="n">conn</span><span class="p">));</span>
<a name="line-316"></a>
<a name="line-317"></a>  <span class="n">g_object_set</span> <span class="p">(</span><span class="n">G_OBJECT</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="s">&quot;use-ssl3&quot;</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-318"></a><span class="p">}</span>
<a name="line-319"></a>
<a name="line-320"></a><span class="cm">/**</span>
<a name="line-321"></a><span class="cm"> * g_tls_client_connection_get_accepted_cas:</span>
<a name="line-322"></a><span class="cm"> * @conn: the #GTlsClientConnection</span>
<a name="line-323"></a><span class="cm"> *</span>
<a name="line-324"></a><span class="cm"> * Gets the list of distinguished names of the Certificate Authorities</span>
<a name="line-325"></a><span class="cm"> * that the server will accept certificates from. This will be set</span>
<a name="line-326"></a><span class="cm"> * during the TLS handshake if the server requests a certificate.</span>
<a name="line-327"></a><span class="cm"> * Otherwise, it will be %NULL.</span>
<a name="line-328"></a><span class="cm"> *</span>
<a name="line-329"></a><span class="cm"> * Each item in the list is a #GByteArray which contains the complete</span>
<a name="line-330"></a><span class="cm"> * subject DN of the certificate authority.</span>
<a name="line-331"></a><span class="cm"> *</span>
<a name="line-332"></a><span class="cm"> * Returns: (element-type GByteArray) (transfer full): the list of</span>
<a name="line-333"></a><span class="cm"> * CA DNs. You should unref each element with g_byte_array_unref() and then</span>
<a name="line-334"></a><span class="cm"> * the free the list with g_list_free().</span>
<a name="line-335"></a><span class="cm"> *</span>
<a name="line-336"></a><span class="cm"> * Since: 2.28</span>
<a name="line-337"></a><span class="cm"> */</span>
<a name="line-338"></a><span class="n">GList</span> <span class="o">*</span>
<a name="line-339"></a><span class="n">g_tls_client_connection_get_accepted_cas</span> <span class="p">(</span><span class="n">GTlsClientConnection</span> <span class="o">*</span><span class="n">conn</span><span class="p">)</span>
<a name="line-340"></a><span class="p">{</span>
<a name="line-341"></a>  <span class="n">GList</span> <span class="o">*</span><span class="n">accepted_cas</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<a name="line-342"></a>
<a name="line-343"></a>  <span class="n">g_return_val_if_fail</span> <span class="p">(</span><span class="n">G_IS_TLS_CLIENT_CONNECTION</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-344"></a>
<a name="line-345"></a>  <span class="n">g_object_get</span> <span class="p">(</span><span class="n">G_OBJECT</span> <span class="p">(</span><span class="n">conn</span><span class="p">),</span> <span class="s">&quot;accepted-cas&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">accepted_cas</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-346"></a>  <span class="k">return</span> <span class="n">accepted_cas</span><span class="p">;</span>
<a name="line-347"></a><span class="p">}</span>
<a name="line-348"></a>
<a name="line-349"></a><span class="cm">/**</span>
<a name="line-350"></a><span class="cm"> * g_tls_client_connection_copy_session_state:</span>
<a name="line-351"></a><span class="cm"> * @conn: a #GTlsClientConnection</span>
<a name="line-352"></a><span class="cm"> * @source: a #GTlsClientConnection</span>
<a name="line-353"></a><span class="cm"> *</span>
<a name="line-354"></a><span class="cm"> * Possibly copies session state from one connection to another, for use</span>
<a name="line-355"></a><span class="cm"> * in TLS session resumption. This is not normally needed, but may be</span>
<a name="line-356"></a><span class="cm"> * used when the same session needs to be used between different</span>
<a name="line-357"></a><span class="cm"> * endpoints, as is required by some protocols, such as FTP over TLS.</span>
<a name="line-358"></a><span class="cm"> * @source should have already completed a handshake and, since TLS 1.3,</span>
<a name="line-359"></a><span class="cm"> * it should have been used to read data at least once. @conn should not</span>
<a name="line-360"></a><span class="cm"> * have completed a handshake.</span>
<a name="line-361"></a><span class="cm"> *</span>
<a name="line-362"></a><span class="cm"> * It is not possible to know whether a call to this function will</span>
<a name="line-363"></a><span class="cm"> * actually do anything. Because session resumption is normally used</span>
<a name="line-364"></a><span class="cm"> * only for performance benefit, the TLS backend might not implement</span>
<a name="line-365"></a><span class="cm"> * this function. Even if implemented, it may not actually succeed in</span>
<a name="line-366"></a><span class="cm"> * allowing @conn to resume @source&#39;s TLS session, because the server</span>
<a name="line-367"></a><span class="cm"> * may not have sent a session resumption token to @source, or it may</span>
<a name="line-368"></a><span class="cm"> * refuse to accept the token from @conn. There is no way to know</span>
<a name="line-369"></a><span class="cm"> * whether a call to this function is actually successful.</span>
<a name="line-370"></a><span class="cm"> *</span>
<a name="line-371"></a><span class="cm"> * Using this function is not required to benefit from session</span>
<a name="line-372"></a><span class="cm"> * resumption. If the TLS backend supports session resumption, the</span>
<a name="line-373"></a><span class="cm"> * session will be resumed automatically if it is possible to do so</span>
<a name="line-374"></a><span class="cm"> * without weakening the privacy guarantees normally provided by TLS,</span>
<a name="line-375"></a><span class="cm"> * without need to call this function. For example, with TLS 1.3,</span>
<a name="line-376"></a><span class="cm"> * a session ticket will be automatically copied from any</span>
<a name="line-377"></a><span class="cm"> * #GTlsClientConnection that has previously received session tickets</span>
<a name="line-378"></a><span class="cm"> * from the server, provided a ticket is available that has not</span>
<a name="line-379"></a><span class="cm"> * previously been used for session resumption, since session ticket</span>
<a name="line-380"></a><span class="cm"> * reuse would be a privacy weakness. Using this function causes the</span>
<a name="line-381"></a><span class="cm"> * ticket to be copied without regard for privacy considerations.</span>
<a name="line-382"></a><span class="cm"> *</span>
<a name="line-383"></a><span class="cm"> * Since: 2.46</span>
<a name="line-384"></a><span class="cm"> */</span>
<a name="line-385"></a><span class="kt">void</span>
<a name="line-386"></a><span class="n">g_tls_client_connection_copy_session_state</span> <span class="p">(</span><span class="n">GTlsClientConnection</span> <span class="o">*</span><span class="n">conn</span><span class="p">,</span>
<a name="line-387"></a>                                            <span class="n">GTlsClientConnection</span> <span class="o">*</span><span class="n">source</span><span class="p">)</span>
<a name="line-388"></a><span class="p">{</span>
<a name="line-389"></a>  <span class="n">g_return_if_fail</span> <span class="p">(</span><span class="n">G_IS_TLS_CLIENT_CONNECTION</span> <span class="p">(</span><span class="n">conn</span><span class="p">));</span>
<a name="line-390"></a>  <span class="n">g_return_if_fail</span> <span class="p">(</span><span class="n">G_IS_TLS_CLIENT_CONNECTION</span> <span class="p">(</span><span class="n">source</span><span class="p">));</span>
<a name="line-391"></a>  <span class="n">g_return_if_fail</span> <span class="p">(</span><span class="n">G_TLS_CLIENT_CONNECTION_GET_INTERFACE</span> <span class="p">(</span><span class="n">conn</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">copy_session_state</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-392"></a>
<a name="line-393"></a>  <span class="n">G_TLS_CLIENT_CONNECTION_GET_INTERFACE</span> <span class="p">(</span><span class="n">conn</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">copy_session_state</span> <span class="p">(</span><span class="n">conn</span><span class="p">,</span>
<a name="line-394"></a>                                                                    <span class="n">source</span><span class="p">);</span>
<a name="line-395"></a><span class="p">}</span>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.3 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
