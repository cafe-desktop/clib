
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Cppcheck - HTML report - clib (cppcheck 2.3-1)</title>
    <link rel="stylesheet" href="style.css">
    <style>
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding: 0 5px 0 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding: 0 5px 0 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #ffffff; }
.highlight .c { color: #888888 } /* Comment */
.highlight .err { color: #FF0000; background-color: #FFAAAA } /* Error */
.highlight .k { color: #008800; font-weight: bold } /* Keyword */
.highlight .o { color: #333333 } /* Operator */
.highlight .ch { color: #888888 } /* Comment.Hashbang */
.highlight .cm { color: #888888 } /* Comment.Multiline */
.highlight .cp { color: #557799 } /* Comment.Preproc */
.highlight .cpf { color: #888888 } /* Comment.PreprocFile */
.highlight .c1 { color: #888888 } /* Comment.Single */
.highlight .cs { color: #cc0000; font-weight: bold } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008800; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008800; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008800; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #003388; font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { color: #008800; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #333399; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #6600EE; font-weight: bold } /* Literal.Number */
.highlight .s { background-color: #fff0f0 } /* Literal.String */
.highlight .na { color: #0000CC } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #BB0066; font-weight: bold } /* Name.Class */
.highlight .no { color: #003366; font-weight: bold } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #880000; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #FF0000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0066BB; font-weight: bold } /* Name.Function */
.highlight .nl { color: #997700; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #007700 } /* Name.Tag */
.highlight .nv { color: #996633 } /* Name.Variable */
.highlight .ow { color: #000000; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #6600EE; font-weight: bold } /* Literal.Number.Bin */
.highlight .mf { color: #6600EE; font-weight: bold } /* Literal.Number.Float */
.highlight .mh { color: #005588; font-weight: bold } /* Literal.Number.Hex */
.highlight .mi { color: #0000DD; font-weight: bold } /* Literal.Number.Integer */
.highlight .mo { color: #4400EE; font-weight: bold } /* Literal.Number.Oct */
.highlight .sa { background-color: #fff0f0 } /* Literal.String.Affix */
.highlight .sb { background-color: #fff0f0 } /* Literal.String.Backtick */
.highlight .sc { color: #0044DD } /* Literal.String.Char */
.highlight .dl { background-color: #fff0f0 } /* Literal.String.Delimiter */
.highlight .sd { color: #DD4422 } /* Literal.String.Doc */
.highlight .s2 { background-color: #fff0f0 } /* Literal.String.Double */
.highlight .se { color: #666666; font-weight: bold; background-color: #fff0f0 } /* Literal.String.Escape */
.highlight .sh { background-color: #fff0f0 } /* Literal.String.Heredoc */
.highlight .si { background-color: #eeeeee } /* Literal.String.Interpol */
.highlight .sx { color: #DD2200; background-color: #fff0f0 } /* Literal.String.Other */
.highlight .sr { color: #000000; background-color: #fff0ff } /* Literal.String.Regex */
.highlight .s1 { background-color: #fff0f0 } /* Literal.String.Single */
.highlight .ss { color: #AA6600 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0066BB; font-weight: bold } /* Name.Function.Magic */
.highlight .vc { color: #336699 } /* Name.Variable.Class */
.highlight .vg { color: #dd7700; font-weight: bold } /* Name.Variable.Global */
.highlight .vi { color: #3333BB } /* Name.Variable.Instance */
.highlight .vm { color: #996633 } /* Name.Variable.Magic */
.highlight .il { color: #0000DD; font-weight: bold } /* Literal.Number.Integer.Long */
    </style>
    <script>
      function getStyle(el, styleProp) {
        var y;

        if (el.currentStyle) {
          y = el.currentStyle[styleProp];
        } else if (window.getComputedStyle) {
          y = document.defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);
        }

        return y;
      }

      function toggle() {
        var el = this.expandable_content;
        var mark = this.expandable_marker;

        if (el.style.display === "block") {
          el.style.display = "none";
          mark.textContent = "[+]";
        } else {
          el.style.display = "block";
          mark.textContent = "[-]";
        }
      }

      function initExpandables() {
        var elements = document.querySelectorAll(".expandable");

        for (var i = 0, len = elements.length; i < len; i++) {
          var el = elements[i];
          var clickable = el.querySelector("span");
          var marker = clickable.querySelector(".marker");
          var content = el.querySelector(".content");
          var width = clickable.clientWidth - parseInt(getStyle(content, "padding-left")) - parseInt(getStyle(content, "padding-right"));
          content.style.width = width + "px";
          clickable.expandable_content = content;
          clickable.expandable_marker = marker;
          clickable.addEventListener("click", toggle);
        }
      }

      function toggleDisplay(id) {
        var elements = document.querySelectorAll("." + id);

        for (var i = 0, len = elements.length; i < len; i++) {
          elements[i].classList.toggle("d-none");
        }
      }

      function toggleAll() {
        var elements = document.querySelectorAll("input");

        // starting from 1 since 0 is the "toggle all" input
        for (var i = 1, len = elements.length; i < len; i++) {
          var el = elements[i];

          if (el.checked) {
            el.checked = false;
          } else {
            el.checked = true;
          }

          toggleDisplay(el.id);
        }
      }
      window.addEventListener("load", initExpandables);
    </script>
  </head>
  <body>
    <div id="header" class="header">
      <h1>Cppcheck report - clib (cppcheck 2.3-1): gio/tests/srvtarget.c</h1>
    </div>
    <div class="wrapper">
      <div id="menu">
       <p id="filename"><a href="index.html">Defects:</a> srvtarget.c</p>
<a href="205.html#line-142"> syntaxError 142</a>
    </div>
    <div id="content">
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157</pre></div></td><td class="code"><div class="highlight"><pre><span></span><a name="line-1"></a><span class="cm">/* GLib testing framework examples and tests</span>
<a name="line-2"></a><span class="cm"> * Copyright (C) 2009 Red Hat, Inc.</span>
<a name="line-3"></a><span class="cm"> *</span>
<a name="line-4"></a><span class="cm"> * This work is provided &quot;as is&quot;; redistribution and modification</span>
<a name="line-5"></a><span class="cm"> * in whole or in part, in any medium, physical or electronic is</span>
<a name="line-6"></a><span class="cm"> * permitted without restriction.</span>
<a name="line-7"></a><span class="cm"> *</span>
<a name="line-8"></a><span class="cm"> * This work is distributed in the hope that it will be useful,</span>
<a name="line-9"></a><span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="line-10"></a><span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<a name="line-11"></a><span class="cm"> *</span>
<a name="line-12"></a><span class="cm"> * In no event shall the authors or contributors be liable for any</span>
<a name="line-13"></a><span class="cm"> * direct, indirect, incidental, special, exemplary, or consequential</span>
<a name="line-14"></a><span class="cm"> * damages (including, but not limited to, procurement of substitute</span>
<a name="line-15"></a><span class="cm"> * goods or services; loss of use, data, or profits; or business</span>
<a name="line-16"></a><span class="cm"> * interruption) however caused and on any theory of liability, whether</span>
<a name="line-17"></a><span class="cm"> * in contract, strict liability, or tort (including negligence or</span>
<a name="line-18"></a><span class="cm"> * otherwise) arising in any way out of the use of this software, even</span>
<a name="line-19"></a><span class="cm"> * if advised of the possibility of such damage.</span>
<a name="line-20"></a><span class="cm"> */</span>
<a name="line-21"></a>
<a name="line-22"></a><span class="cp">#include</span> <span class="cpf">&lt;glib/glib.h&gt;</span><span class="cp"></span>
<a name="line-23"></a><span class="cp">#include</span> <span class="cpf">&lt;gio/gio.h&gt;</span><span class="cp"></span>
<a name="line-24"></a><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<a name="line-25"></a><span class="cp">#include</span> <span class="cpf">&lt;string.h&gt;</span><span class="cp"></span>
<a name="line-26"></a>
<a name="line-27"></a><span class="cp">#define NUM_TRIALS 250000</span>
<a name="line-28"></a>
<a name="line-29"></a><span class="k">struct</span> <span class="p">{</span>
<a name="line-30"></a>  <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">order</span><span class="p">;</span>
<a name="line-31"></a>  <span class="kt">int</span> <span class="n">expected</span><span class="p">,</span> <span class="n">seen</span><span class="p">;</span>
<a name="line-32"></a><span class="p">}</span> <span class="n">ordering</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
<a name="line-33"></a>  <span class="cm">/* There are 32 legitimate orderings; the result always has to start</span>
<a name="line-34"></a><span class="cm">   * with either &quot;fe&quot; (usually) or &quot;ef&quot; (rarely). For the remaining</span>
<a name="line-35"></a><span class="cm">   * letters, &quot;cbda&quot; is the most likely, with various other orders</span>
<a name="line-36"></a><span class="cm">   * possible, down to &quot;adbc&quot; being the most improbable. However,</span>
<a name="line-37"></a><span class="cm">   * almost all &quot;fe&quot; orderings are more likely than almost any &quot;ef&quot;</span>
<a name="line-38"></a><span class="cm">   * orderings. The complete probability ordering, from most-likely</span>
<a name="line-39"></a><span class="cm">   * to least-likely is something roughly like:</span>
<a name="line-40"></a><span class="cm">   */</span>
<a name="line-41"></a>  <span class="p">{</span> <span class="s">&quot;fecbda&quot;</span><span class="p">,</span> <span class="mf">0.2468</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-42"></a>  <span class="p">{</span> <span class="s">&quot;febcda&quot;</span><span class="p">,</span> <span class="mf">0.1885</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-43"></a>  <span class="p">{</span> <span class="s">&quot;fecdba&quot;</span><span class="p">,</span> <span class="mf">0.1346</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-44"></a>  <span class="p">{</span> <span class="s">&quot;fedcba&quot;</span><span class="p">,</span> <span class="mf">0.0830</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-45"></a>  <span class="p">{</span> <span class="s">&quot;febdca&quot;</span><span class="p">,</span> <span class="mf">0.0706</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-46"></a>  <span class="p">{</span> <span class="s">&quot;fedbca&quot;</span><span class="p">,</span> <span class="mf">0.0571</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-47"></a>  <span class="p">{</span> <span class="s">&quot;fecbad&quot;</span><span class="p">,</span> <span class="mf">0.0496</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-48"></a>  <span class="p">{</span> <span class="s">&quot;febcad&quot;</span><span class="p">,</span> <span class="mf">0.0374</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-49"></a>  <span class="p">{</span> <span class="s">&quot;fecabd&quot;</span><span class="p">,</span> <span class="mf">0.0185</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-50"></a>  <span class="p">{</span> <span class="s">&quot;fecdab&quot;</span><span class="p">,</span> <span class="mf">0.0136</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-51"></a>  <span class="p">{</span> <span class="s">&quot;fecadb&quot;</span><span class="p">,</span> <span class="mf">0.0110</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-52"></a>  <span class="p">{</span> <span class="s">&quot;febacd&quot;</span><span class="p">,</span> <span class="mf">0.0108</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-53"></a>  <span class="p">{</span> <span class="s">&quot;feacbd&quot;</span><span class="p">,</span> <span class="mf">0.0096</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-54"></a>  <span class="p">{</span> <span class="s">&quot;fedcab&quot;</span><span class="p">,</span> <span class="mf">0.0083</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-55"></a>  <span class="p">{</span> <span class="s">&quot;feabcd&quot;</span><span class="p">,</span> <span class="mf">0.0073</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-56"></a>  <span class="p">{</span> <span class="s">&quot;feacdb&quot;</span><span class="p">,</span> <span class="mf">0.0058</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-57"></a>  <span class="p">{</span> <span class="s">&quot;efcbda&quot;</span><span class="p">,</span> <span class="mf">0.0049</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-58"></a>  <span class="p">{</span> <span class="s">&quot;febdac&quot;</span><span class="p">,</span> <span class="mf">0.0048</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-59"></a>  <span class="p">{</span> <span class="s">&quot;febadc&quot;</span><span class="p">,</span> <span class="mf">0.0043</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-60"></a>  <span class="p">{</span> <span class="s">&quot;fedbac&quot;</span><span class="p">,</span> <span class="mf">0.0038</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-61"></a>  <span class="p">{</span> <span class="s">&quot;efbcda&quot;</span><span class="p">,</span> <span class="mf">0.0038</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-62"></a>  <span class="p">{</span> <span class="s">&quot;feadcb&quot;</span><span class="p">,</span> <span class="mf">0.0036</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-63"></a>  <span class="p">{</span> <span class="s">&quot;fedacb&quot;</span><span class="p">,</span> <span class="mf">0.0035</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-64"></a>  <span class="p">{</span> <span class="s">&quot;feabdc&quot;</span><span class="p">,</span> <span class="mf">0.0029</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-65"></a>  <span class="p">{</span> <span class="s">&quot;feadbc&quot;</span><span class="p">,</span> <span class="mf">0.0026</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-66"></a>  <span class="p">{</span> <span class="s">&quot;fedabc&quot;</span><span class="p">,</span> <span class="mf">0.0026</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-67"></a>  <span class="p">{</span> <span class="s">&quot;efcdba&quot;</span><span class="p">,</span> <span class="mf">0.0026</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-68"></a>  <span class="p">{</span> <span class="s">&quot;efdcba&quot;</span><span class="p">,</span> <span class="mf">0.0017</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-69"></a>  <span class="p">{</span> <span class="s">&quot;efbdca&quot;</span><span class="p">,</span> <span class="mf">0.0014</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-70"></a>  <span class="p">{</span> <span class="s">&quot;efdbca&quot;</span><span class="p">,</span> <span class="mf">0.0011</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-71"></a>  <span class="p">{</span> <span class="s">&quot;efcbad&quot;</span><span class="p">,</span> <span class="mf">0.0010</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-72"></a>  <span class="p">{</span> <span class="s">&quot;efbcad&quot;</span><span class="p">,</span> <span class="mf">0.0008</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-73"></a>  <span class="p">{</span> <span class="s">&quot;efcabd&quot;</span><span class="p">,</span> <span class="mf">0.0004</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-74"></a>  <span class="p">{</span> <span class="s">&quot;efcdab&quot;</span><span class="p">,</span> <span class="mf">0.0003</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-75"></a>  <span class="p">{</span> <span class="s">&quot;efcadb&quot;</span><span class="p">,</span> <span class="mf">0.0002</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-76"></a>  <span class="p">{</span> <span class="s">&quot;efbacd&quot;</span><span class="p">,</span> <span class="mf">0.0002</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-77"></a>  <span class="p">{</span> <span class="s">&quot;efacbd&quot;</span><span class="p">,</span> <span class="mf">0.0002</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-78"></a>  <span class="p">{</span> <span class="s">&quot;efdcab&quot;</span><span class="p">,</span> <span class="mf">0.0002</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-79"></a>  <span class="p">{</span> <span class="s">&quot;efabcd&quot;</span><span class="p">,</span> <span class="mf">0.0002</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-80"></a>  <span class="p">{</span> <span class="s">&quot;efacdb&quot;</span><span class="p">,</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-81"></a>  <span class="p">{</span> <span class="s">&quot;efbdac&quot;</span><span class="p">,</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-82"></a>  <span class="p">{</span> <span class="s">&quot;efadcb&quot;</span><span class="p">,</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-83"></a>  <span class="p">{</span> <span class="s">&quot;efdbac&quot;</span><span class="p">,</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-84"></a>  <span class="p">{</span> <span class="s">&quot;efbadc&quot;</span><span class="p">,</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-85"></a>  <span class="p">{</span> <span class="s">&quot;efdacb&quot;</span><span class="p">,</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-86"></a>  <span class="p">{</span> <span class="s">&quot;efabdc&quot;</span><span class="p">,</span> <span class="mf">0.0001</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-87"></a>  <span class="p">{</span> <span class="s">&quot;efadbc&quot;</span><span class="p">,</span> <span class="mf">0.00005</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<a name="line-88"></a>  <span class="p">{</span> <span class="s">&quot;efdabc&quot;</span><span class="p">,</span> <span class="mf">0.00005</span> <span class="o">*</span> <span class="n">NUM_TRIALS</span><span class="p">,</span> <span class="mi">0</span><span class="p">}</span>
<a name="line-89"></a><span class="p">};</span>
<a name="line-90"></a><span class="cp">#define NUM_ORDERINGS G_N_ELEMENTS (ordering)</span>
<a name="line-91"></a>
<a name="line-92"></a><span class="k">static</span> <span class="kt">void</span>
<a name="line-93"></a><span class="n">test_srv_target_ordering</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<a name="line-94"></a><span class="p">{</span>
<a name="line-95"></a>  <span class="n">GList</span> <span class="o">*</span><span class="n">targets</span><span class="p">,</span> <span class="o">*</span><span class="n">sorted</span><span class="p">,</span> <span class="o">*</span><span class="n">t</span><span class="p">;</span>
<a name="line-96"></a>  <span class="kt">char</span> <span class="n">result</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
<a name="line-97"></a>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<a name="line-98"></a>  <span class="n">guint</span> <span class="n">o</span><span class="p">;</span>
<a name="line-99"></a>
<a name="line-100"></a>  <span class="n">targets</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<a name="line-101"></a>  <span class="cm">/*                                 name, port, priority, weight */</span>
<a name="line-102"></a>  <span class="n">targets</span> <span class="o">=</span> <span class="n">g_list_append</span> <span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">g_srv_target_new</span> <span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
<a name="line-103"></a>  <span class="n">targets</span> <span class="o">=</span> <span class="n">g_list_append</span> <span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">g_srv_target_new</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">));</span>
<a name="line-104"></a>  <span class="n">targets</span> <span class="o">=</span> <span class="n">g_list_append</span> <span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">g_srv_target_new</span> <span class="p">(</span><span class="s">&quot;c&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">));</span>
<a name="line-105"></a>  <span class="n">targets</span> <span class="o">=</span> <span class="n">g_list_append</span> <span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">g_srv_target_new</span> <span class="p">(</span><span class="s">&quot;d&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">));</span>
<a name="line-106"></a>  <span class="n">targets</span> <span class="o">=</span> <span class="n">g_list_append</span> <span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">g_srv_target_new</span> <span class="p">(</span><span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
<a name="line-107"></a>  <span class="n">targets</span> <span class="o">=</span> <span class="n">g_list_append</span> <span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">g_srv_target_new</span> <span class="p">(</span><span class="s">&quot;f&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">));</span>
<a name="line-108"></a>
<a name="line-109"></a>  <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NUM_TRIALS</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<a name="line-110"></a>    <span class="p">{</span>
<a name="line-111"></a>      <span class="n">g_random_set_seed</span> <span class="p">(</span><span class="n">i</span><span class="p">);</span>
<a name="line-112"></a>
<a name="line-113"></a>      <span class="n">sorted</span> <span class="o">=</span> <span class="n">g_srv_target_list_sort</span> <span class="p">(</span><span class="n">g_list_copy</span> <span class="p">(</span><span class="n">targets</span><span class="p">));</span>
<a name="line-114"></a>
<a name="line-115"></a>      <span class="k">for</span> <span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="n">sorted</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span> <span class="n">t</span><span class="p">;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">t</span><span class="o">-&gt;</span><span class="n">next</span><span class="p">)</span>
<a name="line-116"></a>	<span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">++</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="n">g_srv_target_get_hostname</span> <span class="p">(</span><span class="n">t</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">);</span>
<a name="line-117"></a>      <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<a name="line-118"></a>      <span class="n">g_list_free</span> <span class="p">(</span><span class="n">sorted</span><span class="p">);</span>
<a name="line-119"></a>
<a name="line-120"></a>      <span class="k">for</span> <span class="p">(</span><span class="n">o</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">o</span> <span class="o">&lt;</span> <span class="n">NUM_ORDERINGS</span><span class="p">;</span> <span class="n">o</span><span class="o">++</span><span class="p">)</span>
<a name="line-121"></a>	<span class="p">{</span>
<a name="line-122"></a>	  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">strcmp</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">ordering</span><span class="p">[</span><span class="n">o</span><span class="p">].</span><span class="n">order</span><span class="p">))</span>
<a name="line-123"></a>	    <span class="p">{</span>
<a name="line-124"></a>	      <span class="n">ordering</span><span class="p">[</span><span class="n">o</span><span class="p">].</span><span class="n">seen</span><span class="o">++</span><span class="p">;</span>
<a name="line-125"></a>	      <span class="k">break</span><span class="p">;</span>
<a name="line-126"></a>	    <span class="p">}</span>
<a name="line-127"></a>	<span class="p">}</span>
<a name="line-128"></a>
<a name="line-129"></a>      <span class="cm">/* Assert that @result matched one of the valid orderings */</span>
<a name="line-130"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">o</span> <span class="o">==</span> <span class="n">NUM_ORDERINGS</span><span class="p">)</span>
<a name="line-131"></a>	<span class="p">{</span>
<a name="line-132"></a>	  <span class="kt">char</span> <span class="o">*</span><span class="n">msg</span> <span class="o">=</span> <span class="n">g_strdup_printf</span> <span class="p">(</span><span class="s">&quot;result &#39;%s&#39; is invalid&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
<a name="line-133"></a>	  <span class="n">g_assertion_message</span> <span class="p">(</span><span class="n">G_LOG_DOMAIN</span><span class="p">,</span> <span class="n">__FILE__</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">G_STRFUNC</span><span class="p">,</span> <span class="n">msg</span><span class="p">);</span>
<a name="line-134"></a>	<span class="p">}</span>
<a name="line-135"></a>    <span class="p">}</span>
<a name="line-136"></a>
<a name="line-137"></a>  <span class="cm">/* Assert that each ordering appeared roughly the expected</span>
<a name="line-138"></a><span class="cm">   * number of times.</span>
<a name="line-139"></a><span class="cm">   */</span>
<a name="line-140"></a>  <span class="k">for</span> <span class="p">(</span><span class="n">o</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">o</span> <span class="o">&lt;</span> <span class="n">NUM_ORDERINGS</span><span class="p">;</span> <span class="n">o</span><span class="o">++</span><span class="p">)</span>
<a name="line-141"></a>    <span class="p">{</span>
<a name="line-142"></a><span class="hll">      <span class="n">g_assert_cmpint</span> <span class="p">(</span><span class="n">ordering</span><span class="p">[</span><span class="n">o</span><span class="p">].</span><span class="n">seen</span><span class="p">,</span> <span class="o">&gt;</span><span class="p">,</span> <span class="n">ordering</span><span class="p">[</span><span class="n">o</span><span class="p">].</span><span class="n">expected</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span><span class="error2">&lt;--- syntax error</span>
</span><a name="line-143"></a>      <span class="n">g_assert_cmpint</span> <span class="p">(</span><span class="n">ordering</span><span class="p">[</span><span class="n">o</span><span class="p">].</span><span class="n">seen</span><span class="p">,</span> <span class="o">&lt;</span><span class="p">,</span> <span class="n">ordering</span><span class="p">[</span><span class="n">o</span><span class="p">].</span><span class="n">expected</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
<a name="line-144"></a>    <span class="p">}</span>
<a name="line-145"></a>
<a name="line-146"></a>  <span class="n">g_resolver_free_targets</span> <span class="p">(</span><span class="n">targets</span><span class="p">);</span>
<a name="line-147"></a><span class="p">}</span>
<a name="line-148"></a>
<a name="line-149"></a><span class="kt">int</span>
<a name="line-150"></a><span class="n">main</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<a name="line-151"></a><span class="p">{</span>
<a name="line-152"></a>  <span class="n">g_test_init</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">argc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">argv</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<a name="line-153"></a>
<a name="line-154"></a>  <span class="n">g_test_add_func</span> <span class="p">(</span><span class="s">&quot;/srvtarget/srv-target-ordering&quot;</span><span class="p">,</span> <span class="n">test_srv_target_ordering</span><span class="p">);</span>
<a name="line-155"></a>
<a name="line-156"></a>  <span class="k">return</span> <span class="nf">g_test_run</span><span class="p">();</span>
<a name="line-157"></a><span class="p">}</span>
</pre></div>
</td></tr></table>
      </div> <!-- /.wrapper -->
    </div>
    <div id="footer" class="footer">
      <p>
        Cppcheck 2.3 - a tool for static C/C++ code analysis<br>
        <br>
        Internet: <a href="http://cppcheck.net">http://cppcheck.net</a><br>
        IRC: <a href="irc://irc.freenode.net/cppcheck">irc://irc.freenode.net/cppcheck</a><br>
      </p>
    </div>
  </body>
</html>
